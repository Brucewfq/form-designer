Ext.BLANK_IMAGE_URL="/Commons/Ext/Images/default/s.gif";document.onhelp=function(){return false};window.onhelp=function(){return false};function keyDownHandler(a){if(a){if(a.keyCode==112){alert("\u5e2e\u52a9\u5236\u4f5c\u4e2d!!!");a.preventDefault();a.stopPropagation()}}else{if(window.event.keyCode==112){alert("\u5e2e\u52a9\u5236\u4f5c\u4e2d!!!");window.event.keyCode=0;return false}}}document.onkeydown=keyDownHandler;String.prototype.trim=function(){return Ext.util.Format.trim(this)};String.prototype.tirmLeftComma=function(){if(this.indexOf(",")==0){return this?this.substring(1):this}else{return this}};String.prototype.getQuery=function(a){var b=new RegExp("(^|&)"+a+"=([^&]*)(&|$)");var c=this.substring(this.indexOf("?")+1).match(b);if(c!=null){return unescape(c[2])}return""};Date.prototype.getDaysByEndDate=function(a){return this.getElapsed(a)/(1000*60*60*24)+1};Array.prototype.insert=function(b,a){if(b>=0){this.splice(b,0,a)}return this};Array.prototype.removeAt=function(b,a){a=a||1;this.splice(b,a);return this};if(!Number.prototype.toFixed){Number.prototype.toFixed=function(a){var b=(this<1)?this+1:this;b=String(Math.round(b*Math.pow(10,a)));var d=b.substr(0,b.length-a);var c=b.substring(b.length-a);b=((this<1)?0:d)+"."+c;return b}}if(Ext.isGecko){XMLDocument.prototype.loadXML=function(d){var e=this.childNodes;for(var b=e.length-1;b>=0;b--){this.removeChild(e[b])}var f=new DOMParser();var a=f.parseFromString(d,"text/xml");var c=this.importNode(a.documentElement,true);this.appendChild(c)};if(document.implementation.hasFeature("XPath","3.0")){XMLDocument.prototype.selectNodes=function(d,e){if(!e){e=this}var b=this.createNSResolver(this.documentElement);var a=this.evaluate(d,e,b,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null);var f=[];for(var c=0;c<a.snapshotLength;c++){f[c]=a.snapshotItem(c)}return f};XMLDocument.prototype.selectSingleNode=function(b,c){if(!c){c=this}var a=this.selectNodes(b,c);if(a.length>0){return a[0]}else{return null}};Element.prototype.selectNodes=function(a){if(this.ownerDocument.selectNodes){return this.ownerDocument.selectNodes(a,this)}else{throw"For XML Elements Only"}};Element.prototype.selectSingleNode=function(a){if(this.ownerDocument.selectSingleNode){return this.ownerDocument.selectSingleNode(a,this)}else{throw"For XML Elements Only"}}}}Ext.override(Ext.form.Field,{initComponent:Ext.form.Field.prototype.initComponent.createSequence(function(){this.enableBubble("change");if(this.allowBlank===false&&this.allowBlankTip===true){this.addClass("x-form-field-allowblank")}}),getBubbleTarget:function(){if(!this.formPanel){this.formPanel=this.findParentByType("form")}return this.formPanel},hide:function(){Ext.form.Field.superclass.hide.call(this);if(this.labelWrap){Ext.fly(this.labelWrap).setDisplayed(false)}else{if(this.getEl()){var a=this.getEl().parent(".x-form-item");if(a!=null&&a!=undefined){a.setDisplayed(false)}}}return this},show:function(){Ext.form.Field.superclass.show.call(this);if(this.labelWrap){Ext.fly(this.labelWrap).setDisplayed(true)}else{if(this.getEl()){var a=this.getEl().parent(".x-form-item");if(a!=null&&a!=undefined){a.setDisplayed(true)}}}return this}});Ext.override(Ext.form.Label,{setText:function(a){this.text=a;if(this.rendered){this.el.update(a)}}});Ext.override(Ext.form.TextField,{validator:function(a){if(this.allowBlank==false&&Ext.util.Format.trim(a).length==0){return false}else{return true}}});Ext.override(Ext.form.NumberField,{onRender:function(b,a){Ext.form.NumberField.superclass.onRender.call(this,b,a);if(this.maxLength!=Number.MAX_VALUE){this.el.dom.setAttribute("maxlength",this.maxLength)}}});Ext.override(Ext.Button,{initComponent:Ext.Button.prototype.initComponent.createSequence(function(){this.on("render",function(){if(this.alt){this.setAlt(this.alt)}})}),setAlt:function(a){this.alt=a;if(this.alt){this.el.set({title:this.alt})}return this},getAlt:function(){return this.alt}});Ext.override(Ext.grid.GridPanel,{updateCellValue:function(e,b,d){var a=this.store.fields.keys[b];var c=this.store.data.items[e];c.set(a,d);this.getView().refresh();return this}});Ext.override(Ext.data.Store,{appendData:function(a){this.loadData(WhiteShell.Globle.toArray(a),true)}});Ext.override(Ext.grid.ColumnModel,{addColumns:function(e){var d,h,a,g;if(!Ext.isArray(e)){e=[e]}var b=this.config;g=b.length;for(d=0,a=e.length;d<a;d++){h=Ext.applyIf(e[d],this.defaults);if(Ext.isEmpty(h.id)){h.id=d+g}if(!h.isColumn){var f=Ext.grid.Column.types[h.xtype||"gridcolumn"];h=new f(h);b[d+g]=h}this.lookup[h.id]=h}this.fireEvent("configchange",this)}});Ext.util.formatXml=function(a){var c="";var b=/(>)(<)(\/*)/g;a=a.replace(b,"$1\r\n$2$3");var d=0;Ext.each(a.split("\r\n"),function(h,f){var e=0;if(h.match(/.+<\/\w[^>]*>$/)){e=0}else{if(h.match(/^<\/\w/)){if(d!=0){d-=1}}else{if(h.match(/^<\w[^>]*[^\/]>.*$/)){e=1}else{e=0}}}var j="";for(var g=0;g<d;g++){j+="  "}c+=j+h+"\r\n";d+=e});return c};Ext.namespace("Ext.ux.clone");Ext.ux.clone=function(d){if(!d||"object"!==typeof d){return d}if("function"===typeof d.clone){return d.clone()}var e="[object Array]"===Object.prototype.toString.call(d)?[]:{};var b,a;for(b in d){if(Object.prototype.hasOwnProperty.call(d,b)){a=d[b];if(a&&"object"===typeof a){e[b]=Ext.ux.clone(a)}else{e[b]=a}}}return e};Ext.form.UnitField=Ext.extend(Ext.form.NumberField,{unitText:"",onRender:function(b,a){Ext.form.UnitField.superclass.onRender.call(this,b,a);this.unitEl=b.createChild({tag:"span",html:this.unitText});this.unitEl.addClass("x-form-unit")},alignErrorIcon:function(){this.errorIcon.alignTo(this.unitEl,"tl-tr",[2,0])}});Ext.reg("unitfield",Ext.form.UnitField);Ext.form.Span=Ext.extend(Ext.form.DisplayField,{cls:"x-form-span",fieldClass:"x-form-field",emptyText:null,emptyClass:"x-form-empty-field"});Ext.reg("spanfield",Ext.form.Span);Ext.Toolbar.FillWidth=function(a){this.width=a.width;Ext.Toolbar.FillWidth.superclass.constructor.call(this,a)};Ext.extend(Ext.Toolbar.FillWidth,Ext.Toolbar.Spacer,{render:function(a){a.style.width=this.width?this.width:"100%";Ext.Toolbar.FillWidth.superclass.render.call(this,a)}});Ext.reg("tbfillwidth",Ext.Toolbar.FillWidth);Ext.data.XmlStore=function(a){Ext.data.XmlStore.superclass.constructor.call(this,Ext.apply(a,{proxy:!a.data?new Ext.data.HttpProxy({url:a.url}):undefined,reader:new Ext.data.XmlReader(a,a.fields)}))};Ext.extend(Ext.data.XmlStore,Ext.data.Store);Ext.util.Format.comboRenderer=function(a){return function(c){if(!a){a=this.editor}var b=a.findRecord(a.valueField,c);return b?b.get(a.displayField):c}};Ext.util.Format.getComboText=Ext.util.Format.comboRenderer;Ext.util.Format.exchangeRateMoney=function(a){if(a==""){return}return a.toFixed(4)};Ext.util.Format.timeToFloat=function(b){if(b!=undefiled&&b!=null){var a=b.split(":");return parseInt(parseInt(a[1])/6)/10}else{return 0}};Ext.util.Format.money=function(a){if(a==undefined){a=0}if(typeof(a)=="string"){a=parseFloat(a)}a=a.toFixed(2);return Ext.util.Format.currency(a)};Ext.util.Format.money2=function(a){if(a==undefined||a==null||a==""){a=0}if(typeof(a)=="string"){a=parseFloat(a)}a=a.toFixed(2);return a};Ext.util.Format.currency=function(a){var e=a.split(".");var d=e[0];var b=e[1];var c=/(\d+)(\d{3})/;while(c.test(d)){d=d.replace(c,"$1,$2")}a=d+"."+b;return a};Ext.ux.newGuid=function(a){var b="";for(var c=1;c<=32;c++){var d=Math.floor(Math.random()*16).toString(16);b+=d;if(a===true){if((c==8)||(c==12)||(c==16)||(c==20)){b+="-"}}}return b};Ext.CalendarPicker=function(a){this.addEvents("update");if(!a.dateFormat){a.dateFormat="Y/m/d"}Ext.CalendarPicker.superclass.constructor.call(this,a);this.bindStore()};Ext.extend(Ext.CalendarPicker,Ext.DatePicker,{bindStore:function(){if(!this.store&&this.storeConfig){this.store=new Ext.data.XmlStore(config.storeConfig)}this.store.on("loadexception",function(){this.loading=false;if(this.el){this.afterUpdate(this.activeDate)}},this);this.store.on("beforeload",function(){this.loading=true;return true},this);this.store.on("load",function(){this.loading=false;if(this.el){this.afterUpdate(this.activeDate)}},this);this.store.on("clear",function(){if(this.el){this.afterUpdate(this.activeDate);this.unmask()}},this)},isRefresh:function(b){var a=this.activeDate;if(a&&this.el){var c=b.getTime();if(a.getMonth()==b.getMonth()&&a.getFullYear()==b.getFullYear()){this.cells.each(function(d){if(d.dom.firstChild.dateValue==c){return false}});return false}}return true},update:function(a,c){var b=this.isRefresh(a);if(!this._mask){this.createMask()}Ext.CalendarPicker.superclass.update.call(this,a,c);if(b){if(!this.store.url){this.mask()}this.fireEvent("update",this,a.getDaysInMonth());if(this.loading!==true){this.afterUpdate(a)}}},afterUpdate:function(d){if(!this.renderer){return}var c=this.cells.elements;var f=this.textNodes;var g,b;var a=new Date(c[0].firstChild.dateValue);for(var e=0;e<f.length;e++){g=a.dateFormat(this.dateFormat);b=this.queryRecordsByDate(a);f[e].innerHTML=this.renderer(g,b);a.setDate(a.getDate()+1)}},handleDateClick:function(b,a){b.stopEvent();if(a.dateValue&&!Ext.fly(a.parentNode).hasClass("x-date-disabled")){this.setValue(new Date(a.dateValue));this.fireEvent("select",this,this.value,this.queryRecordsByDate(this.value))}},selectToday:function(){this.setValue(new Date().clearTime());this.fireEvent("select",this,this.value,this.queryRecordsByDate(this.value))},queryRecordsByDate:function(b){var a=this;var c=this.store.queryBy(function(d,e){return Date.parse(b)==Date.parse(d.get(a.dateField).clearTime())});if(c.getCount()==0){return null}else{return c}},setValue:function(a){if(!a){a=new Date()}else{if(!(a instanceof Date)){a=new Date(a)}}Ext.CalendarPicker.superclass.setValue.call(this,a)},getValue:function(){return this.value},createMask:function(){if(!this._mask){this._mask=new Ext.LoadMask(this.el,{store:this.store})}},mask:function(){if(!this._mask){this.createMask()}this._mask.show()},unmask:function(){this._mask.hide()}});Ext.reg("calendarpicker",Ext.CalendarPicker);Ext.form.FCKeditor=function(a){if(!a.id){a.id=Ext.id()}if(!a.name){a.name=a.id}Ext.form.FCKeditor.superclass.constructor.call(this,a);this.MyisLoaded=false;this.MyValue=""};Ext.extend(Ext.form.FCKeditor,Ext.form.TextArea,{editorInstance:undefined,BasePath:"/web/fckeditor/",SkinPath:null,height:100,initEvents:function(){this.on("destroy",function(){if(typeof this.editorInstance!="undefined"){delete this.editorInstance}})},onRender:function(b,a){if(!this.el){this.defaultAutoCreate={tag:"textarea",style:"width:100px;height:60px;",autocomplete:"off"}}Ext.form.TextArea.superclass.onRender.call(this,b,a);this.hideMode="visibility";this.hidden=true;if(this.grow){this.textSizeEl=Ext.DomHelper.append(document.body,{tag:"pre",cls:"x-form-grow-sizer"});if(this.preventScrollbars){this.el.setStyle("overflow","hidden")}this.el.setHeight(this.growMin)}this.on("render",function(){var c=new FCKeditor(this.id);c.BasePath=this.BasePath;if(this.SkinPath){c.Config.SkinPath=this.SkinPath}c.Height=this.height;c.ReplaceTextarea()})},setValue:function(a){this.instanceValue=a;if(this.instanceLoaded){this.FCKeditorSetValue(a)}Ext.form.TextArea.superclass.setValue.apply(this,[a])},setIsLoaded:function(a){this.instanceLoaded=a},getIsLoaded:function(){return this.instanceLoaded},getValue:function(){if(this.instanceLoaded){value=this.FCKeditorGetValue();Ext.form.TextArea.superclass.setValue.apply(this,[value]);return Ext.form.TextArea.superclass.getValue.call(this)}else{return this.instanceValue}},getRawValue:function(){if(this.instanceLoaded){value=this.FCKeditorGetValue();Ext.form.TextArea.superclass.setRawValue.apply(this,[value]);return Ext.form.TextArea.superclass.getRawValue.call(this)}else{return this.instanceValue}},FCKeditorSetValue:function(c){if(this.instanceLoaded==false){return}var b=new Ext.util.TaskRunner();var a={run:function(){try{var e=this.editorInstance;if(e.EditorDocument.body){e.SetData(c);b.stop(a)}}catch(d){}},interval:100,scope:this};b.start(a)},FCKeditorGetValue:function(){var a="";if(this.instanceLoaded==false){return a}a=this.editorInstance.GetData();return a}});Ext.reg("fckeditor",Ext.form.FCKeditor);function FCKeditor_OnComplete(a){var b=Ext.getCmp(a.Name);b.editorInstance=a;b.instanceLoaded=true;b.FCKeditorSetValue(b.instanceValue)}Ext.apply(Ext.form.VTypes,{daterange:function(d,c){var b=c.parseDate(d);if(!b){return}if(c.startDateField&&(!this.dateRangeMax||(b.getTime()!=this.dateRangeMax.getTime()))){var e=Ext.getCmp(c.startDateField);e.setMaxValue(b);this.dateRangeMax=b;e.validate()}else{if(c.endDateField&&(!this.dateRangeMin||(b.getTime()!=this.dateRangeMin.getTime()))){var a=Ext.getCmp(c.endDateField);a.setMinValue(b);this.dateRangeMin=b;a.validate()}}return true}});Ext.form.ChooseTriggerField=Ext.extend(Ext.form.TwinTriggerField,{editable:false,trigger1Class:"x-form-clear-trigger",trigger2Class:"x-form-org-trigger",hideTrigger1:true,initComponent:function(){Ext.form.ChooseTriggerField.superclass.initComponent.call(this)},onRender:function(b,a){Ext.form.ChooseTriggerField.superclass.onRender.call(this,b,a);if(!this.hiddenName){this.hiddenName=Ext.id()}this.hiddenField=this.el.insertSibling({tag:"input",type:"hidden",name:this.hiddenName,id:(this.hiddenId||Ext.id())},"before",true)},getText:function(){return this.el.dom.value},setText:function(a){this.el.dom.value=a},getValue:function(){var a=this.value;if(a===this.emptyText||a===undefined){a=""}return a},setValue:function(b,c){var d=b,a=c||b;if(this.hiddenField){this.hiddenField.value=Ext.value(a,"")}Ext.form.ChooseTriggerField.superclass.setValue.call(this,d);this.value=a;if(a!==this.emptyText&&a!==undefined&&a!==""){this.triggers[0].show()}return this},onTrigger1Click:function(){if(this.hasSearch){this.el.dom.value="";this.value="";this.triggers[0].hide();this.hasSearch=false}},onTrigger2Click:function(){if(this.handler){this.handler.call(this.scope||this,this)}this.hasSearch=true},onDestroy:function(){Ext.destroyMembers(this,"hiddenField");Ext.form.ChooseTriggerField.superclass.onDestroy.call(this)}});Ext.reg("choosetriggerfield",Ext.form.ChooseTriggerField);Ext.ux.IconCombo=function(a){Ext.ux.IconCombo.superclass.constructor.call(this,a);this.tpl=a.tpl||'<tpl for="."><div class="x-combo-list-item"><table><tbody><tr><td><div class="x-icon-combo-icon"><img style="width:16px;height:16px;" alt="" src="{'+this.iconClsField+'}" /></div></td><td>{'+this.displayField+"}</td></tr></tbody></table></div></tpl>";this.on({render:{scope:this,fn:function(){var b=this.el.up("div.x-form-field-wrap");this.flag=Ext.DomHelper.append(b,{tag:"div",style:"position:absolute"})}}})};Ext.extend(Ext.ux.IconCombo,Ext.form.ComboBox,{setIconCls:function(){var a=this.store.query(this.valueField,this.getValue()).itemAt(0);if(a){this.flag.className="x-icon-combo-icon "+a.get(this.iconClsField)}},setValue:function(a){Ext.ux.IconCombo.superclass.setValue.call(this,a);this.setIconCls()}});Ext.namespace("WhiteShell.Globle");var WSG=WhiteShell.Globle;WSG.closeWindow=function(){if(Ext.isIE6){window.opener=null;window.close()}else{if(Ext.isIE7){window.open("","_self","");window.close()}}if(Ext.isSafari){window.opener=null;window.open("","_self");window.close()}else{window.top.opener=null;window.close()}};function setCookie(b,c,a){var d=new Date();d.setDate(d.getDate()+a);document.cookie=b+"="+escape(c)+((a==null)?"":";expires="+d.toGMTString())}function getCookie(c){if(document.cookie.length>0){var a=document.cookie.split(";");for(var d=0;d<a.length;d++){c_start=a[d].indexOf(c);if(c_start!=-1){var b=a[d].split("=");return unescape(b[1])}}}return""}WhiteShell.Globle.Cookies={get:getCookie,set:setCookie};WhiteShell.Globle.toArray=function(b){var a=[b];if(b instanceof Array){return b}return a};WhiteShell.Globle.guid=function(a){return Ext.ux.newGuid(a)};WhiteShell.Globle.toXmlStandardization=function(a){if(typeof(a)=="string"){a=a.replace(/&/g,"&amp;");a=a.replace(/</g,"&lt;");a=a.replace(/>/g,"&gt;");a=a.replace(/\'/g,"&apos;");a=a.replace(/\"/g,"&quot;")}return a};WhiteShell.Globle.fromXmlStandardization=function(a){if(typeof(a)=="string"){a=a.replace(/\&lt\;/g,"<");a=a.replace(/\&gt\;/g,">");a=a.replace(/\&apos;/g,"'");a=a.replace(/\&quot\;/g,'"');a=a.replace(/\&amp\;/g,"&")}return a};WhiteShell.Globle.outputType=1;WhiteShell.Globle.GetExtComponetByName=function(a,d){var c=null;for(var b=0;b<a.form.items.items.length;b++){if(a.form.items.items[b].name==d){c=a.form.items.items[b];break}}return c};Ext.namespace("WhiteShell.Globle.Polocy");WhiteShell.Globle.Polocy.maxPrice=function(a){return function(b){if(b==""){return true}return b<=WhiteShell.FormAssembly.businessForm.getPolicyByName(a)}};Ext.form.Field.override({isField:true});WhiteShell.Globle.CompType={BLOCK:"block",GRID:"grid",FIELD:"field",CONTAINER:"container",OTHER:"other",getCompType:function(a){var b=a.getXType?a.getXType():a.xtype;switch(b){case"textfield":case"trigger":case"textarea":case"combo":case"checkbox":case"radio":case"hidden":case"htmleditor":case"datefield":case"timefield":case"numberfield":case"spanfield":case"calendarpicker":case"fckeditor":case"commoncombo":case"displayfield":case"checkboxgroup":case"radiogroup":case"hytriggerfield":case"ubidisplayfield":return this.FIELD;case"grid":case"editorgrid":case"multipleupload":case"upload":return this.GRID;case"formblock":case"formsubwinblock":return this.BLOCK;case"form":case"panel":case"tabpanel":case"window":return this.CONTAINER;default:return this.OTHER}}};WhiteShell.Globle.DataFormat={nowDate:function(){return(new Date()).dateFormat("Y/m/d")},gridStoreSerialization:function(b){if(!b){return null}var a={row:[]};Ext.each(b.data.items,function(c){var d={};for(var e in c.data){if(c.data[e]!=undefined&&c.data[e]!=null){if(c.data[e] instanceof Date){d[e]=c.data[e].dateFormat("Y/m/d H:i:s")}else{d[e]=c.data[e].toString()}}}a.row.push(d)});return a},gridStoreDeserialize:function(a,b){if(!a.row){return}b.appendData(a.row)},fieldsSerialization:function(a,b){if(!a){return null}if(!b){b={}}Ext.each(a,function(d){switch(d.getXType()){case"combo":case"commoncombo":var f=d.getValue();b[d.name+"_Value"]=f;var e=d.getEl().getValue()||f;b[d.name+"_Text"]=e;break;case"radio":b[d.id]=d.getGroupValue();break;case"datefield":case"calendarpicker":if(d.getValue()!=""){b[d.name]=d.getValue().dateFormat("Y/m/d")}else{b[d.name]=""}break;case"timefield":if(d.getValue()!=""){if(d.getValue() instanceof Date){b[d.name]=d.getValue().dateFormat("Y/m/d H:i:s")}else{b[d.name]=d.getValue()}}else{b[d.name]=""}break;default:var c=(!d.getValue()&&d.getValue()!==false);if((c||d.needOutput===true)&&b[d.name]){delete b[d.name]}else{if(d.getValue()=="&#160;"){b[d.name]=""}else{b[d.name]=d.getValue()}}break}});return b},fieldsDeserialize:function(a,b){Ext.each(WhiteShell.Globle.toArray(b),function(c){var d=c.name;switch(c.getXType()){case"combo":case"commoncombo":if(a[d+"_Value"]){c.setValue(a[d+"_Value"])}if(a[d+"_Text"]){c.getEl().dom.value=a[d+"_Text"]}break;case"radio":if(a[c.id]){c.setValue(a[c.id])}c.fireEvent("check",c);break;case"datefield":case"calendarpicker":case"timefield":if(a[d]){c.setValue(new Date(a[d]))}break;case"spanfield":if(a[d]){c.setValue(a[d])}break;default:if(a[d]){c.setValue(a[d])}break}})},calculate:function(a){return this.calculateByColName(a,null)},calculateByColName:function(b,p){var k,a,o,n=b.getView().cm.config,d;var e=b.store;var f=e.getRange(0,e.getCount()-1);var m=b.getView().getColumnData();if(f.length>0){for(var g=0,q=f.length;g<q;g++){a=f[g];for(var h=0,l=m.length;h<l;h++){o=m[h];d=n[h];if((!p||o.name==p)&&d.summaryType){k=Ext.grid.GroupSummary.Calculations[d.summaryType](k||0,a,o.name,k)}}}}else{k=0}return k},generateJsonFromStore:function(e){var f;var b=e.data.items;switch(WhiteShell.Globle.outputType){case 0:f="";for(var d=0;d<b.length;d++){var a=b[d];var c=a.data;var g="";f+=","+this.jsonObj2JsonStr(c)}f=this.createJsonflag("row",[f.tirmLeftComma()]);break;case 1:f={};f.row=[];for(var d=0;d<b.length;d++){var a=b[d];var c=a.data;f.row.push(c)}break;case 2:f="";for(var d=0;d<b.length;d++){var a=b[d];var c=a.data;var g="";f+=this.createXmlflag("row",this.jsonObj2XmlStr(c))}break}return f},jsonObj2JsonStr:function(c){var a="";for(var b in c){a+=","+this.createJsonflag(b,this.escape(c[b]))}return"{"+a.tirmLeftComma()+"}"},jsonObj2XmlStr:function(c){var b="";for(var a in c){b+=this.createXmlflag(a,this.escape(c[a]))}return b},escape:function(a){if(a instanceof Date){a=a.dateFormat("Y/m/d")}return a.toString().replace("\\","\\\\").replace("'","\\'").replace("<","&lt;").replace(">",">")},createXmlflag:function(a,b){return"<"+a+">"+b+"</"+a+">"},createJsonflag:function(a,c,b){switch(c.constructor){case Array:return a+":["+c.toString()+"]";case Boolean:return a+":"+c.toString();case Number:return a+":"+c;default:if(b){return a+":{"+c.toString()+"}"}else{return a+":'"+c+"'"}}},json2xml:function(d,c){var e=function(g,j,o){var h="";if(g instanceof Array){for(var k=0,p=g.length;k<p;k++){h+=o+e(g[k],j,o+"\t")+"\n"}}else{if(typeof(g)=="object"){var l=false;h+=o+"<"+j;for(var f in g){if(f.charAt(0)=="@"){h+=" "+f.substr(1)+'="'+g[f].toString()+'"'}else{l=true}}h+=l?">":"/>";if(l){for(var f in g){if(f=="#text"){h+=WhiteShell.Globle.toXmlStandardization(g[f])}else{if(f=="#cdata"){h+="<![CDATA["+g[f]+"]]>"}else{if(f.charAt(0)!="@"){h+=e(g[f],f,o+"\t")}}}}h+=(h.charAt(h.length-1)=="\n"?o:"")+"</"+j+">"}}else{h+=o+"<"+j+">"+WhiteShell.Globle.toXmlStandardization(g.toString())+"</"+j+">"}}return h};var b="";for(var a in d){b+=e(d[a],a,"")}return c?b.replace(/\t/g,c):b.replace(/\t|\n/g,"")},object2Xml:function(d,c){var e=function(g,j,o){var h="";if(g instanceof Array){for(var k=0,p=g.length;k<p;k++){h+=o+e(g[k],j,o+"\t")+"\n"}}else{if(typeof(g)=="object"){var l=false;h+=o+"<"+j;for(var f in g){if(f.charAt(0)=="@"){h+=" "+f.substr(1)+'="'+g[f].toString()+'"'}else{l=true}}h+=l?">":"/>";if(l){for(var f in g){if(f=="#text"){h+=WhiteShell.Globle.toXmlStandardization(g[f])}else{if(f=="#cdata"){h+="<![CDATA["+g[f]+"]]>"}else{if(f.charAt(0)!="@"){h+=e(g[f],f,o+"\t")}}}}h+=(h.charAt(h.length-1)=="\n"?o:"")+"</"+j+">"}}else{h+=o+"<"+j+">"+WhiteShell.Globle.toXmlStandardization(g.toString())+"</"+j+">"}}return h};var b="";for(var a in d){b+=e(d[a],a,"")}return c?b.replace(/\t/g,c):b.replace(/\t|\n/g,"")},atoc:function(f){var b=f<0;var f=new String(Math.round(Math.abs(f)*100));var l="";var d="\u96f6\u58f9\u8d30\u53c1\u8086\u4f0d\u9646\u67d2\u634c\u7396";var c="\u4e07\u4edf\u4f70\u62fe\u4ebf\u4edf\u4f70\u62fe\u4e07\u4edf\u4f70\u62fe\u5143\u89d2\u5206";var k=f.length;var g;var e;var j=0;var a;if(k>20){alert("\u91d1\u989d\u6570\u5df2\u8d85\u8fc7\u8ba1\u7b97\u8303\u56f4\uff0c\u91d1\u989d\u603b\u6570\u8d85\u8fc720\u4f4d");return""}if(f==0){l="\u96f6\u5143\u6574";return l}c=c.substr(c.length-k,k);for(var h=0;h<k;h++){a=parseInt(f.substr(h,1),10);if(h!=(k-3)&&h!=(k-7)&&h!=(k-11)&&h!=(k-15)){if(a==0){g="";e="";j=j+1}else{if(a!=0&&j!=0){g="\u96f6"+d.substr(a,1);e=c.substr(h,1);j=0}else{g=d.substr(a,1);e=c.substr(h,1);j=0}}}else{if(a!=0&&j!=0){g="\u96f6"+d.substr(a,1);e=c.substr(h,1);j=0}else{if(a!=0&&j==0){g=d.substr(a,1);e=c.substr(h,1);j=0}else{if(a==0&&j>=3){g="";e="";j=j+1}else{g="";e=c.substr(h,1);j=j+1}}}if(h==(k-11)||h==(k-3)){e=c.substr(h,1)}}l=l+g+e}if(a==0){l=l+"\u6574"}if(b){l="\u8d1f"+l}return l}};WhiteShell.Globle.Uri={UrlParm:(function(){return{parm:function(c){function b(d){return d.substring(d.indexOf("#"))}function a(d){var e=new RegExp("(^|&)"+d+"=([^&]*)(&|$)");var f=b(window.location.search).substr(1).match(e);if(f!=null){return decodeURI(f[2])}return null}return a(c)},hasParm:function(a){return !!this.parm(a)}}})()};var UrlParm=WhiteShell.Globle.Uri.UrlParm;function cmbk_openWindowMax(a){window.open(a,"","left=0,top=0,width="+(screen.availWidth-10)+",height="+(screen.availHeight-160)+",toolbar=yes,menubar=yes,scrollbars=no,status=yes,location=yes,resizable=yes")}Ext.util.appendCustomColumn=function(a,g){var d=WhiteShell.FormAssembly.businessForm;var e=a.id;var m="GridCustomColumns.ashx";var j=function(){var s=a.getColumnModel();var p=[];for(var u=0;u<s.getColumnCount();u++){var x=s.getColumnId(u);if(x=="checker"||x=="numberer"){continue}var q=s.getColumnById(u);var t;if(q.hideable+""=="undefined"){if(q.hidden+""=="undefined"){t=true}else{if(q.hidden+""=="true"){t=false}else{t=true}}}else{if(q.hidden+""=="undefined"){if(q.hidden+""=="true"){t=false}else{t=true}}else{if(q.hidden+""=="true"){t=false}else{t=true}}}var o=new Ext.form.Checkbox({boxLabel:"<span style='font-size:15px'>"+q.header+"</span>",id:q.dataIndex,checked:t});p[p.length]=o}var r=20*p.length+100;var w=new Ext.Panel({layout:"form",width:290,height:r-20,frame:true,labelWidth:10,items:p});var v=new Ext.Window({title:"\u9009\u62e9\u5217",width:300,height:r,frame:true,modal:true,border:false,items:w,buttonAlign:"center",buttons:[{text:"\u786e\u5b9a",handler:function(){v.close();b(a,p)}}]});v.show()};var b=function(o,w){if(true){var s=o.getColumnModel();for(var u=0;u<s.getColumnCount();u++){var x=s.getColumnId(u);if(x=="checker"||x=="numberer"){continue}var r=s.getColumnById(u);for(var t=0;t<w.length;t++){if(r.dataIndex==w[t].id){if(w[t].checked){r.hidden=false}else{r.hidden=true}}}}o.view.colModel=new Ext.grid.ColumnModel(s);o.view.refresh(true);var q="";for(var v=0;v<s.getColumnCount();v++){var p=s.getColumnId(v);var r=s.getColumnById(p);var y=s.getDataIndex(v);if(y!=""){q+=r.header+","+r.dataIndex+","+(!r.hidden?"false":r.hidden.toString())+","+v.toString()+","+(r.width?r.width:"50")+"|"}}q=q.substring(0,q.length-1);Ext.Ajax.request({url:m,params:{method:"GridCustomColumns_Save",procsetName:g,gridId:e,customColumnList:q},success:function(i){Ext.Msg.alert("\u63d0\u793a","\u4fdd\u5b58\u6210\u529f\uff01")},failure:function(){Ext.Msg.alert("\u63d0\u793a","\u4fdd\u5b58\u5931\u8d25\uff01")}})}};var c=function(){Ext.Msg.confirm("\u63d0\u793a","\u786e\u8ba4\u6e05\u9664\u81ea\u5b9a\u4e49\u5217\u4fe1\u606f?",function(i){if(i=="yes"){Ext.Ajax.request({url:m,params:{method:"GridCustomColumns_Delete",procsetName:g,gridId:e},success:function(o){Ext.Msg.alert("\u63d0\u793a","\u6e05\u9664\u6210\u529f\uff01")},failure:function(){Ext.Msg.alert("\u63d0\u793a","\u6e05\u9664\u5931\u8d25\uff01")}})}})};var k=a.tools;if(!k){k=[];a.tools=k}k.push({id:"save",text:"\u4fdd\u5b58\u81ea\u5b9a\u4e49\u5217",qtip:"\u4fdd\u5b58\u81ea\u5b9a\u4e49\u5217",specFlag:"customFlag",handler:j});k.push({id:"close",text:"\u6e05\u9664\u81ea\u5b9a\u4e49\u4fe1\u606f",qtip:"\u6e05\u9664\u81ea\u5b9a\u4e49\u4fe1\u606f",specFlag:"customFlag",handler:c});if(d!=null&&(!d.isOriginate()&&d.getViewState()!="republish")&&(((self.location+"").indexOf("AccountPayable.aspx")!=-1)||((self.location+"").indexOf("AffirmPayment.aspx")!=-1)||((self.location+"").indexOf("PrintMediaProcess.aspx")!=-1))){var n=a.topToolbar;for(var f=0;f<n.length;f++){if(n[f].text=="\u653e\u5927\u663e\u793a"){k.push({id:"refresh",text:"\u653e\u5927/\u7f29\u5c0f\u663e\u793a",qtip:"\u653e\u5927/\u7f29\u5c0f\u663e\u793a",specFlag:"customFlag",handler:n[f].handler})}}}var h=new Ext.data.Store({proxy:new Ext.data.HttpProxy({url:m,method:"POST",timeout:120000}),baseParams:{method:"GridCustomColumns_Get",procsetName:g,gridId:e},reader:new Ext.data.XmlReader({record:"Table",totalRecords:"result"},[{name:"Id"},{name:"ProcsetName"},{name:"EmpId"},{name:"GridId"},{name:"ColumnName"},{name:"ColumnIndex"},{name:"IsHidden"},{name:"OrderId"},{name:"ColumnWidth"}])});var l=a.getColumnModel();h.on("load",function(o){if(o.data.length>0){var i=[];Ext.each(o.data.items,function(r){var u={};u.header=r.data.ColumnName;u.dataIndex=r.data.ColumnIndex;var x=l.getColumnCount();for(var t=0;t<x;t++){var v=l.getColumnId(t);var s=l.getColumnById(v);var w=l.getDataIndex(t);if(w==u.dataIndex){u=s;break}}if(r.data.IsHidden.toLowerCase()!="true"&&r.data.IsHidden.toLowerCase()!="1"){hidden=false}else{hidden=true}u.hidden=hidden;u.hideable=true;u.sortable=true;u.width=parseInt(r.data.ColumnWidth);i.push(u)});var p=new Ext.grid.ColumnModel(i);a.view.colModel=new Ext.grid.ColumnModel(p);var p=a.getColumnModel();var q=p.getColumnCount();Ext.each(o.data.items,function(s){var x=s.data.OrderId;var r=0;for(var u=0;u<q;u++){var w=p.getColumnId(u);var t=p.getColumnById(w);if(t.dataIndex==s.data.ColumnIndex){r=u;break}}if(x!=r){var v=p.config[x];p.config[x]=p.config[r];p.config[r]=v}});a.view.refresh(true)}});h.load()};function _showBigFormBlock(c,d,a){var b={panelParent:c.ownerCt,po:c.ownerCt.items.indexOfKey(c.id),size:c.getSize()};c.header.hide("display");var e=new Ext.Window({title:c.title,closable:true,width:d||700,height:a||b.size.height,border:false,plain:true,layout:"fit",plain:true,items:c,modal:true,maximizable:(d||a),maximized:(!d&&!a),listeners:{close:function(f){b.panelParent.insert(b.po,c);c.header.show();c.setSize(b.size.width,b.size.height);b.panelParent.doLayout();e.destroy()}}});e.show(this)}var SHOW_BIG_GRID_FLG=false;var SHOW_BIG_GRID_FLG_DO=false;var newVisiableArray=new Array();var isFirstShowBigFlg=true;function __showBigGrid(a,n,o,g){var x=[];var u=n.caller.blockArray;for(var t=0;t<u.length;t++){if(n.id!=u[t].id){x[t]=u[t].id}}var q=screen.width-60;var w=screen.height;for(var t=0;t<x.length;t++){if(x[t]!=""){if(!SHOW_BIG_GRID_FLG){if(Ext.getCmp(x[t])&&Ext.getCmp(x[t]).isVisible()){newVisiableArray.push(x[t]);Ext.getCmp(x[t]).hide()}}else{for(var r=0;r<newVisiableArray.length;r++){if(newVisiableArray[r]==x[t]){Ext.getCmp(x[t]).show()}}}}}var c=a.getColumnModel();var m=c.getColumnCount();for(var s=0;s<m;s++){var f=c.getColumnWidth(s);if(c.getDataIndex(s)&&c.getDataIndex(s)!=""){if(!SHOW_BIG_GRID_FLG){a.getView().forceFit=true;c.setColumnWidth(s,f)}else{a.getView().forceFit=false;c.setColumnWidth(s,f)}}}if(SHOW_BIG_GRID_FLG){a.setWidth(o);a.setHeight(g);Ext.getCmp(n.caller.id).setWidth(o+20)}else{a.setWidth(q);a.setHeight(w-400);Ext.getCmp(n.caller.id).setWidth(q)}if(!SHOW_BIG_GRID_FLG){SHOW_BIG_GRID_FLG=true}else{SHOW_BIG_GRID_FLG=false}var e=document.getElementsByTagName("button");for(var t=0;t<e.length;t++){if(e[t].innerHTML=="\u653e\u5927\u663e\u793a"){e[t].innerHTML="\u7f29\u5c0f\u663e\u793a"}else{if(e[t].innerHTML=="\u7f29\u5c0f\u663e\u793a"){e[t].innerHTML="\u653e\u5927\u663e\u793a"}}}return;SHOW_BIG_GRID_FLG_DO=true;var p=document.getElementsByTagName("div");var e=document.getElementsByTagName("button");var q=screen.width-60;var w=screen.height-400;var h=q-o;for(var t=0;t<p.length;t++){if(!SHOW_BIG_GRID_FLG){var l=(o+"").substring(0,1);if(p[t].style&&p[t].style.width){var v=p[t].style.width+"";v=v.replace("px","");var b=parseInt(v,10);if(b<=o&&(o-50)<=b&&v.indexOf(l)==0){b+=h;p[t].style.width=b+"px"}}}else{if(p[t].style&&p[t].style.width){var v=p[t].style.width+"";v=v.replace("px","");var b=parseInt(v,10);b=b-h;if(b<=o&&(o-50)<=b){p[t].style.width=b+"px"}}}}if(!SHOW_BIG_GRID_FLG){a.setHeight(w)}else{a.setHeight(g)}for(var t=0;t<e.length;t++){if(e[t].innerHTML=="\u653e\u5927\u663e\u793a"){e[t].innerHTML="\u7f29\u5c0f\u663e\u793a"}else{if(e[t].innerHTML=="\u7f29\u5c0f\u663e\u793a"){e[t].innerHTML="\u653e\u5927\u663e\u793a"}}}if(x){for(var t=0;t<x.length;t++){if(x[t]!=""){if(Ext.getCmp(x[t])){if(!SHOW_BIG_GRID_FLG){Ext.getCmp(x[t]).hide()}else{Ext.getCmp(x[t]).show()}}}}}var d=WhiteShell.FormAssembly.businessForm;if(newHideArray&&d!=null&&(!d.isOriginate()&&d.getViewState()!="republish")){if(isFirstShowBigFlg){for(var t=0;t<newHideArray.length;t++){if(newHideArray[t]!=""){if(Ext.getCmp(newHideArray[t])){if(!SHOW_BIG_GRID_FLG){if(Ext.getCmp(newHideArray[t]).isVisible()){Ext.getCmp(newHideArray[t]).hide();newVisiableArray.push(newHideArray[t])}}else{Ext.getCmp(newHideArray[t]).show()}}}}isFirstShowBigFlg=false}else{for(var t=0;t<newVisiableArray.length;t++){if(!SHOW_BIG_GRID_FLG){Ext.getCmp(newVisiableArray[t]).hide()}else{Ext.getCmp(newVisiableArray[t]).show()}}}}if(!SHOW_BIG_GRID_FLG){SHOW_BIG_GRID_FLG=true}else{SHOW_BIG_GRID_FLG=false}SHOW_BIG_GRID_FLG_DO=false}Ext.namespace("HY.ChooseWidgetMgr");HY.ChooseWidgetMgr=Ext.apply(new Ext.util.MixedCollection(),{register:function(){for(var a=0,b;(b=arguments[a]);a++){this.add(b)}},unregister:function(){for(var a=0,b;(b=arguments[a]);a++){this.remove(this.lookup(b))}},lookup:function(a){if(!Ext.isObject(a)){a=this.get(a)}if(!(a&&a.events)){a=Ext.create(a,a.xtype||"chooseresources");this.register(a)}return a}});HY.ChooseWidgetMgr.reg=HY.ChooseWidgetMgr.register;HY.ChooseWidgetMgr.unreg=HY.ChooseWidgetMgr.unregister;Ext.namespace("HY.ChooseWidget");HY.ChooseWidget.SelectedRecord2String=function(a,c,e){if(!e){e=","}var d={};Ext.each(a,function(f){for(var g=0;g<c.length;g++){if(!d[c[g]]){d[c[g]]=[]}d[c[g]].push(f.get(c[g]))}});for(var b=0;b<c.length;b++){d[c[b]]=d[c[b]].join(e)}return d};Ext.namespace("HY.RowCloseIcon");HY.RowCloseIcon=function(a){Ext.apply(this,a)};Ext.extend(HY.RowCloseIcon,Ext.util.Observable,{imgIcon:"mygrid-close",init:function(a){this.grid=a;Ext.apply(this.grid.viewConfig,{templates:{row:new Ext.Template('<div class="x-grid3-row {alt} ffffff" style="{tstyle}"><table class="x-grid3-row-table" border="0" cellspacing="0" cellpadding="0" style="{tstyle}">','<tbody><tr>{cells}<td class="'+this.imgIcon+' x-grid3-row-shortcut-delete" style="visibility:hidden;cursor:pointer;margin:3px 4px 0 0;padding:0;"></td></tr>',(this.grid.viewConfig.enableRowBody?'<tr class="x-grid3-row-body-tr" style="{bodyStyle}"><td colspan="{cols}" class="x-grid3-body-cell" tabIndex="0" hidefocus="on"><div class="x-grid3-row-body">{body}</div></td></tr>':""),"</tbody></table></div>")}});this.grid.on("render",function(){var b=this.grid.getView().mainBody;b.on("mousedown",this.onMousedown,this.grid.getView());b.on("mouseover",this.onMouseover,this.grid.getView());b.on("mouseout",this.onMouseout,this.grid.getView())},this)},onMousedown:function(c,b){if(c.button===0&&b.className.indexOf("x-grid3-row-shortcut-delete")>0){c.stopEvent();var d=c.getTarget(".x-grid3-row");if(d){var a=d.rowIndex;this.grid.getStore().removeAt(a)}}},onMouseover:function(c,b){var d;if((d=this.findRowIndex(b))!==false){var a=this.getRow(d);if(Ext.fly(a).child(".x-grid3-row-shortcut-delete")){Ext.fly(a).child(".x-grid3-row-shortcut-delete").show()}}},onMouseout:function(c,b){var d;if((d=this.findRowIndex(b))!==false){var a=this.getRow(d);if(Ext.fly(a).child(".x-grid3-row-shortcut-delete")){Ext.fly(a).child(".x-grid3-row-shortcut-delete").hide()}}}});Ext.namespace("HY.NewRowCloseIcon");HY.NewRowCloseIcon=function(a){Ext.apply(this,a)};Ext.extend(HY.NewRowCloseIcon,Ext.util.Observable,{imgIcon:"mygrid-close",init:function(a){this.grid=a;this.grid.on("render",function(){var b=this.grid.getView().mainBody;b.on("mousedown",this.onMousedown,this);b.on("mouseover",this.onMouseover,this);b.on("mouseout",this.onMouseout,this)},this)},onMousedown:function(c,b){if(c.button===0&&b.className.indexOf("x-grid3-row-editdefaultemp")>=0){c.stopEvent();var d=c.getTarget(".x-grid3-row");if(d){var a=d.rowIndex;this.grid.getStore().removeAt(a)}}},onMouseover:function(c,b){var d;if((d=this.grid.getView().findRowIndex(b))!==false){var a=this.grid.getView().getRow(d);Ext.fly(a).child("."+this.imgIcon).show()}},onMouseout:function(c,b){var d;if((d=this.grid.getView().findRowIndex(b))!==false){var a=this.grid.getView().getRow(d);Ext.fly(a).child("."+this.imgIcon).hide()}}});HY.debug=function(){return{Log:function(a){if(window.console){console.log(a)}},Error:function(a){if(window.console){console.log("Error: "+a)}}}}();HY.Log=HY.debug.Log;HY.Error=HY.debug.Error;HY.ChooseWidget.SelectedObj2Array=function(b,a){if(!a){a=","}var h={};var l=[];var c=0;for(var k in b){l.push(k);if(!b[k]){return null}h[k]=b[k].split(a);c=h[k].length}var d=[];for(var f=0;f<c;f++){var g={};for(var e=0;e<l.length;e++){g[l[e]]=h[l[e]][f]}d.push(g)}return d};HY.ChooseWidget.SelectedRecord2String=function(a,c,e){if(!e){e=","}var d={};Ext.each(a,function(f){for(var g=0;g<c.length;g++){if(!d[c[g]]){d[c[g]]=[]}d[c[g]].push(f.get(c[g]))}});for(var b=0;b<c.length;b++){d[c[b]]=d[c[b]].join(e)}return d};function Ext_Ajax_syncrequest(g){var f="";var d="";if(g.params){for(var c in g.params){f+="&"+c+"="+g.params[c]}}try{var a=Ext.lib.Ajax.getConnectionObject().conn;a.open("GET",g.url+"?method="+g.method+f+"&guid="+(new Date()).getTime(),false);a.send(null);d=a.responseText==""?{}:Ext.decode(a.responseText)}catch(b){if(g.error){g.error(b)}}if(g.success){g.success(d)}}Ext.namespace("UBI.TriggerField");UBI.TriggerField=Ext.extend(Ext.form.TriggerField,{triggerClass:"x-form-hypropertyfield",initComponent:function(){UBI.TriggerField.superclass.initComponent.call(this);this.addEvents("triggerclick")},onTriggerClick:function(a,b){if(this.readOnly||this.disabled){return}this.fireEvent("triggerclick",this,b);this.el.focus()},setValue:function(b){var a=this.getValue();UBI.TriggerField.superclass.setValue.call(this,b);this.fireEvent("change",this,b,a)}});Ext.reg("hytriggerfield",UBI.TriggerField);HY.Image=Ext.extend(Ext.BoxComponent,{src:Ext.BLANK_IMAGE_URL,constructor:function(a){a.autoEl={tag:"img",src:a.src||this.src||Ext.BLANK_IMAGE_URL};HY.Image.superclass.constructor.call(this,a)}});Ext.reg("hyimage",HY.Image);Ext.form.ActionField=Ext.extend(Ext.form.TriggerField,{triggerClass:"x-form-hypropertyfield",beforeBlur:Ext.emptyFn,bindData:Ext.emptyFn,isViewAutoVisible:true,initView:function(){return null},getView:function(){return this.view},validateBlur:function(a){return !this.view||!this.view.isVisible()},onDestroy:function(){Ext.destroy(this.view);Ext.form.ActionField.superclass.onDestroy.call(this)},doShow:Ext.emptyFn,onTriggerClick:function(){if(!this.view){this.view=this.initView()}this.bindData();if(this.isViewAutoVisible&&this.view.show){this.view.show();this.view.setZIndex(this.gridEditor.el.getZIndex()+10)}else{this.doShow()}this.mon(Ext.getDoc(),{scope:this,mousewheel:this.closeView,mousedown:this.closeView})},closeView:function(b){var a=this.view;if(!b.within(this.wrap)&&!a.el.contains(b.target)&&!(a.mask&&a.mask.contains(b.target))&&this.validateBlur(b)){this.beforeBlur(b);if(this.isViewAutoVisible&&a.show){a.hide()}}},displayText:"",wrapFormat:"{0}",enableKeyEvents:true,initEvents:function(){Ext.form.ActionField.superclass.initEvents.call(this);this.dqTask=new Ext.util.DelayedTask(this.initQuery,this);if(!this.enableKeyEvents){this.mon(this.el,"keyup",this.onKeyUp,this)}},enforcementType:"",getDisplay:function(a){var b;if(Ext.isObject(a)){b=a.Display||a.Value}else{b=a}if(this.isBasicType(a)){return b.toString()}else{return String.format(this.wrapFormat,b)}},isBasicType:function(c){var b=this.typeOf(c);var a=Ext.StoreMgr.get("variableType").findBy(function(d){if(d.get("category")=="Basic"&&d.get("type")==b){return true}});return a!=-1},typeOf:function(b){if(!!this.enforcementType){return this.enforcementType}var a;if(Ext.isString(b)&&(b===""||b.length==50)){a="TypeString"}else{if(Ext.isObject(b)){a=b.Type}else{if(Ext.isNumber(b)||/^(-?\d+)(\.\d+)?$/.test(b)){a="TypeInteger"}else{if(Ext.isNumber(b)||b.toLowerCase()==="true"||b.toLowerCase()==="false"){a="TypeBoolean"}else{a="TypeString"}}}}return a},convertBaseType:function(a){if(Ext.isObject(a)){return a}var b;if(Ext.isString(a)&&(a===""||a.length==50)){b={Type:"TypeString",ReturnType:"TypeString",Value:a}}else{if(!!this.enforcementType){b={Type:this.enforcementType,ReturnType:this.enforcementType,Value:a}}else{if(Ext.isNumber(a)||/^(-?\d+)(\.\d+)?$/.test(a)){b={Type:"TypeInteger",ReturnType:"TypeInteger",Value:parseFloat(a)}}else{if(Ext.isNumber(a)||a.toLowerCase()==="true"||a.toLowerCase()==="false"){b={Type:"TypeBoolean",ReturnType:"TypeBoolean",Value:(a===true||a==="true")}}else{b={Type:"TypeString",ReturnType:"TypeString",Value:a}}}}}return b},getValue:function(){if(this.value){return Ext.isDefined(this.value)?this.convertBaseType(this.value):""}else{return Ext.form.ActionField.superclass.getValue.call(this)}},setValue:function(c){var a=this.oValue,b="";if(Ext.isEmpty(c)){this.oValue=null}else{this.oValue=this.convertBaseType(c);b=this.getDisplay(c)}Ext.form.ActionField.superclass.setValue.call(this,b);this.value=this.oValue;this.updateFieldClass(a);return this},updateFieldClass:function(c){if(this.rendered){if(c&&c.Type){var b="x-field-valuetype-"+c.Type;this.el.removeClass(b)}if(this.value&&this.value.Type){var a="x-field-valuetype-"+this.value.Type;this.el.addClass(a)}if(this.value&&this.isBasicType(this.value)){this.el.removeClass("x-field-type-flag")}else{this.el.addClass("x-field-type-flag")}}},onKeyUp:function(b){var a=b.getKey();if(this.readOnly!==true&&(a==b.BACKSPACE||!b.isSpecialKey())){this.lastKey=a;this.dqTask.delay(this.queryDelay)}Ext.form.ActionField.superclass.onKeyUp.call(this,b)},initQuery:function(){this.doQuery(this.getRawValue())},doQuery:function(a){var b=this.oValue;this.value=this.oValue=this.convertBaseType(a);this.updateFieldClass(b)},onDestroy:function(){if(this.dqTask){this.dqTask.cancel();this.dqTask=null}Ext.destroy(this.keyNav,this.oValue);Ext.form.ActionField.superclass.onDestroy.call(this)}});Ext.reg("actionfield",Ext.form.ActionField);Ext.namespace("UBI.Xml");UBI.Xml={selectNodes:function(a,c){try{return a.selectSingleNode(c)}catch(b){return a.querySelectorAll(c)}},selectSingleNode:function(a,c){try{return a.selectSingleNode(c)}catch(b){return a.querySelector(c)}},serializeToString:function(a){if(a.xml){return a.xml}else{var b=new XMLSerializer();return b.serializeToString(a)}},getNodeValue:function(a){if(a.text===undefined){if(a.childNodes.length!=0&&a.childNodes[0].nodeName=="#text"){return a.childNodes[0].nodeValue}else{return a.nodeValue}}else{return a.text}}};
